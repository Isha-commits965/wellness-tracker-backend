# ðŸš€ Render Deployment Guide

## Prerequisites
- GitHub repository with your code
- Render account (free tier available)
- OpenAI API key (optional, for AI features)

## Step 1: Prepare Your Repository

### 1.1 Commit All Files
```bash
git add .
git commit -m "Add production deployment configuration"
git push origin main
```

### 1.2 Verify Required Files
Make sure these files are in your repository:
- `render.yaml` - Render configuration
- `Dockerfile` - Container configuration
- `requirements.txt` - Python dependencies
- `start_production.py` - Production startup script
- `alembic/` - Database migrations
- `app/` - Application code

## Step 2: Deploy to Render

### 2.1 Create Render Account
1. Go to [render.com](https://render.com)
2. Sign up with GitHub
3. Connect your GitHub account

### 2.2 Create New Web Service
1. Click "New +" â†’ "Web Service"
2. Connect your GitHub repository
3. Select your `wellness-tracker-backend` repository

### 2.3 Configure Service Settings

#### Basic Settings:
- **Name**: `wellness-tracker-backend`
- **Environment**: `Python 3`
- **Region**: Choose closest to your users
- **Branch**: `main`

#### Build & Deploy:
- **Build Command**: 
  ```bash
  pip install -r requirements.txt
  alembic upgrade head
  ```
- **Start Command**: 
  ```bash
  python start_production.py
  ```

#### Environment Variables:
Add these environment variables in Render dashboard:

**Required:**
- `SECRET_KEY`: Generate a secure random string
  ```bash
  python -c "import secrets; print(secrets.token_urlsafe(32))"
  ```
- `DATABASE_URL`: Will be auto-generated by Render PostgreSQL

**Optional:**
- `OPENAI_API_KEY`: Your OpenAI API key for AI features
- `DEBUG`: `False`
- `ALGORITHM`: `HS256`
- `ACCESS_TOKEN_EXPIRE_MINUTES`: `30`
- `APP_NAME`: `Wellness Tracker API`

### 2.4 Create PostgreSQL Database
1. In Render dashboard, click "New +" â†’ "PostgreSQL"
2. Name: `wellness-tracker-db`
3. Plan: `Free` (for development)
4. Copy the connection string to `DATABASE_URL`

### 2.5 Deploy
1. Click "Create Web Service"
2. Render will automatically build and deploy your app
3. Wait for deployment to complete (5-10 minutes)

## Step 3: Verify Deployment

### 3.1 Check Health Endpoint
Visit: `https://your-app-name.onrender.com/health`

Expected response:
```json
{"status": "healthy"}
```

### 3.2 Check API Documentation
Visit: `https://your-app-name.onrender.com/docs`

### 3.3 Test Authentication
```bash
# Register a new user
curl -X POST "https://your-app-name.onrender.com/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "testpassword123",
    "full_name": "Test User"
  }'
```

## Step 4: Configure Custom Domain (Optional)

### 4.1 Add Custom Domain
1. Go to your service settings
2. Click "Custom Domains"
3. Add your domain
4. Follow DNS configuration instructions

### 4.2 SSL Certificate
Render automatically provides SSL certificates for custom domains.

## Step 5: Monitor and Maintain

### 5.1 View Logs
- Go to your service dashboard
- Click "Logs" tab
- Monitor application logs in real-time

### 5.2 Database Management
- Access PostgreSQL database through Render dashboard
- Use `alembic` commands for migrations
- Monitor database usage and performance

### 5.3 Scaling
- Free tier: 750 hours/month
- Upgrade to paid plans for more resources
- Configure auto-scaling based on traffic

## Troubleshooting

### Common Issues:

#### 1. Build Fails
- Check `requirements.txt` for missing dependencies
- Verify Python version compatibility
- Check build logs for specific errors

#### 2. Database Connection Issues
- Verify `DATABASE_URL` is correctly set
- Check PostgreSQL service is running
- Ensure database migrations completed

#### 3. Application Crashes
- Check application logs
- Verify all environment variables are set
- Test locally with production settings

#### 4. Slow Performance
- Upgrade to paid plan for better resources
- Optimize database queries
- Implement caching strategies

### Debug Commands:
```bash
# Check service status
curl https://your-app-name.onrender.com/health

# View recent logs
# (Use Render dashboard logs section)

# Test specific endpoint
curl https://your-app-name.onrender.com/auth/me \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## Environment Variables Reference

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `DATABASE_URL` | Yes | - | PostgreSQL connection string |
| `SECRET_KEY` | Yes | - | JWT secret key |
| `OPENAI_API_KEY` | No | - | OpenAI API key for AI features |
| `DEBUG` | No | `False` | Debug mode |
| `ALGORITHM` | No | `HS256` | JWT algorithm |
| `ACCESS_TOKEN_EXPIRE_MINUTES` | No | `30` | Token expiration time |
| `APP_NAME` | No | `Wellness Tracker API` | Application name |

## Production Checklist

- [ ] All code committed to GitHub
- [ ] Environment variables configured
- [ ] Database migrations working
- [ ] Health endpoint responding
- [ ] API documentation accessible
- [ ] Authentication working
- [ ] CORS configured for frontend
- [ ] Error handling implemented
- [ ] Logging configured
- [ ] Monitoring set up

## Security Considerations

1. **Secret Key**: Use a strong, unique secret key
2. **Database**: Use strong passwords and restrict access
3. **CORS**: Configure appropriate CORS origins
4. **HTTPS**: Always use HTTPS in production
5. **Rate Limiting**: Implement rate limiting for API endpoints
6. **Input Validation**: Validate all input data
7. **Error Handling**: Don't expose sensitive information in errors

## Cost Optimization

- **Free Tier**: 750 hours/month, 512MB RAM
- **Paid Plans**: Start at $7/month for more resources
- **Database**: Free PostgreSQL with 1GB storage
- **Bandwidth**: 100GB/month on free tier

## Support

- Render Documentation: https://render.com/docs
- Community Forum: https://community.render.com
- Status Page: https://status.render.com

---

**Your Wellness Tracker Backend is now live on Render! ðŸŽ‰**
